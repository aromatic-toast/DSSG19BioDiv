theme(plot.title = element_text(face = "bold"),
axis.title.x = element_text(face = "bold"),
axis.title.y = element_text(face = "bold"),
axis.text = element_text(face = "bold"))
prop_rainbow_not_fungi
fungi_rainbow_unique_names
nrow(fungi_rainbow)
unique(rainbow_list$Phylum)
# Subst the rainbow fungi
fungi_rainbow <- filter(rainbow_list, Phylum=="Mitosporic fungi" | Phylum=="Ascomycota")
nrow(fungi_rainbow)
# Get the unique fungi names
fungi_rainbow_unique_names <- unique(fungi_rainbow$simplified_names)
# Unqiue fungi species are what percent of the GBIF unique species?
length(fungi_gbif_unique_names)/length(gbif_unique_names)*100
# Unqiue fungi species are what percent of the GBIF unique species?
length(fungi_gbif_unique_names)/length(gbif_unique_names)*100
# Calculate the composition of GBIF and Rainbow in terms of how many fungi they have.
# Record the number of unqiue species that are not fungi on either list  (ie rainbow or gbif)
prop_gbif_not_fungi <- (length(gbif_unique_names)-length(fungi_gbif_unique_names))/length(gbif_unique_names)
prop_rainbow_not_fungi <- (length(rainbow_unique_names)-length(fungi_rainbow_unique_names))/length(rainbow_unique_names)
# make a data frame of the relative proportions
prop_data7 <- data.frame(dataset = c(rep("GBIF",2), rep("Rainbow",2)), catetory = c(rep( c("Non-Fungi","Fungi"), 2)),
prop = c(prop_gbif_not_fungi, length(fungi_gbif_unique_names)/length(gbif_unique_names), prop_rainbow_not_fungi,
length(fungi_rainbow_unique_names)/length(rainbow_unique_names)))
# Make a stacked bar chart indicating the proportion of each list is devoted to plants on GBIF and rainbow
ggplot(prop_data7, aes(x = dataset, y = prop, fill = catetory))+
geom_bar(stat = "identity", position = "fill")+
scale_y_continuous(labels = percent)+
scale_color_few("Dark", drop = FALSE)+
labs(x = "Species Lists", y= "Percentage", fill = "Category",
title = "Proportions of Plant and Non-plant",
subtitle = "GBIF vs Rainbow")+
theme(plot.title = element_text(face = "bold"),
axis.title.x = element_text(face = "bold"),
axis.title.y = element_text(face = "bold"),
axis.text = element_text(face = "bold"))
# What percent of GBIF fungi are found on rainbow?
gbif_fungi_on_rainbow/length(fungi_gbif_unique_names)*100
# How many of the unique GBIF fungi species are found on rainbow list?
gbif_fungi_on_rainbow <- sum(na.omit(unique(fungi_gbif$species))%in%rainbow_list$Scientific.Name);gbif_fungi_on_rainbow
# What percent of GBIF fungi are found on rainbow?
gbif_fungi_on_rainbow/length(fungi_gbif_unique_names)*100
# What percent of Rainbow fungi are found on GBIF?
gbif_fungi_on_rainbow/length(rainbow_unique_names)*100
# What percent of GBIF fungi are found on rainbow?
gbif_fungi_on_rainbow/length(fungi_gbif_unique_names)*100
# What percent of Rainbow fungi are found on GBIF?
gbif_fungi_on_rainbow/length(fungi_rainbow_unique_names)*100
# How many of the unique GBIF fungi species are found on rainbow list?
gbif_fungi_on_rainbow <- sum(na.omit(unique(fungi_gbif$species))%in%rainbow_list$Scientific.Name);gbif_fungi_on_rainbow
# Plot a venn diagram showing the overlap between unique species on GBIF fungi and rainbow fungi
gbif_fungi_rainbow_overlap <- draw.pairwise.venn(area1 = length(fungi_gbif_unique_names),
area2 = length(fungi_rainbow_unique_names),
cross.area = gbif_fungi_on_rainbow,
category = c("GBIF Fungi", "Rainbow Fungi"),
lty = rep("blank", 2),
fill = c("purple", "cyan"),
alpha = rep(0.5,2),
cat.dist = rep(0.025, 2),
scaled = T,
cat.fontface = rep("bold", 2),
ext.text = F,
cat.pos = c(-25, 20))
# make the ven diagram plot titles
title8 <- textGrob("GBIF and Rainbow Fungi", gp=gpar(fontface = "bold"))
subtitle8 <- textGrob("Overlap of unique fungal species", gp=gpar(fontface = "bold"))
grid.arrange(gTree(children = gbif_fungi_rainbow_overlap), top = title8, bottom = subtitle8)
# Record the proportion of unqiue species that do not overlap with the other list (ie rainbow fungi or gbif fungi)
prop_gbif_non_overlap8 <- (length(fungi_gbif_unique_names)-gbif_fungi_on_rainbow)/length(fungi_gbif_unique_names)
prop_rainbow_non_overlap8 <- (length(fungi_rainbow_unique_names)-gbif_fungi_on_rainbow)/length(fungi_rainbow_unique_names)
# make a data frame of the relative proportions
prop_data8 <- data.frame(dataset = c(rep("GBIF Fungi",2), rep("Rainbow Fungi",2)), catetory = c(rep( c("Unique","Overlap"), 2)),
prop = c(num_gbif_non_overlap8, gbif_fungi_on_rainbow/length(fungi_gbif_unique_names), num_rainbow_non_overlap8,
gbif_fungi_on_rainbow/length(fungi_rainbow_unique_names)))
# Record the proportion of unqiue species that do not overlap with the other list (ie rainbow fungi or gbif fungi)
prop_gbif_non_overlap8 <- (length(fungi_gbif_unique_names)-gbif_fungi_on_rainbow)/length(fungi_gbif_unique_names)
prop_rainbow_non_overlap8 <- (length(fungi_rainbow_unique_names)-gbif_fungi_on_rainbow)/length(fungi_rainbow_unique_names)
# make a data frame of the relative proportions
prop_data8 <- data.frame(dataset = c(rep("GBIF Fungi",2), rep("Rainbow Fungi",2)), catetory = c(rep( c("Unique","Overlap"), 2)),
prop = c(prop_gbif_non_overlap8, gbif_fungi_on_rainbow/length(fungi_gbif_unique_names), prop_rainbow_non_overlap8,
gbif_fungi_on_rainbow/length(fungi_rainbow_unique_names)))
# Make a stacked bar chart indicating the proportion of each list is devoted to the overlap between GBIF and rainbow animals
ggplot(prop_data8, aes(x = dataset, y = prop, fill = catetory))+
geom_bar(stat = "identity", position = "fill")+
scale_y_continuous(labels = percent)+
scale_color_few("Dark", drop = FALSE)+
labs(x = "Species Lists", y= "Percentage", fill = "Category",
title = "Proportions of unique and overlapping",
subtitle = "GBIF Fungi vs Rainbow Fungi")+
theme(plot.title = element_text(face = "bold"),
axis.title.x = element_text(face = "bold"),
axis.title.y = element_text(face = "bold"),
axis.text = element_text(face = "bold"))
# Fungi found on rainbow are what percent of GBIF species?
gbif_fungi_on_rainbow/length(fungi_gbif_unique_names)*100
# What percent of the rainbow list are the fungi species found on GBIF?
gbif_fungi_on_rainbow/fungi_rainbow_unique_names*100
# What percent of the rainbow list are the fungi species found on GBIF?
gbif_fungi_on_rainbow/lenght(fungi_rainbow_unique_names)*100
# Fungi found on rainbow are what percent of GBIF species?
gbif_fungi_on_rainbow/length(fungi_gbif_unique_names)*100
# What percent of the rainbow list are the fungi species found on GBIF?
gbif_fungi_on_rainbow/length(fungi_rainbow_unique_names)*100
gbif_fungi_on_rainbow/length(gbif_unique_names)
gbif_fungi_on_rainbow/length(gbif_unique_names)*100
gbif_fungi_on_rainbow/length(rainbow_unique_names)*100
# Make a stacked bar chart indicating the proportion of each list is devoted to plants on GBIF and rainbow
ggplot(prop_data7, aes(x = dataset, y = prop, fill = catetory))+
geom_bar(stat = "identity", position = "fill")+
scale_y_continuous(labels = percent)+
scale_color_few("Dark", drop = FALSE)+
labs(x = "Species Lists", y= "Percentage", fill = "Category",
title = "Proportions of Fungi and Non-fungi",
subtitle = "GBIF vs Rainbow")+
theme(plot.title = element_text(face = "bold"),
axis.title.x = element_text(face = "bold"),
axis.title.y = element_text(face = "bold"),
axis.text = element_text(face = "bold"))
# Record the proportion of unqiue species that do not overlap with the other list (ie rainbow or gbif)
prop_gbif_non_overlap <- (length(gbif_unique_names)-gbif_rainbow_intersect)/length(gbif_unique_names)
prop_rainbow_non_overlap <- (length(rainbow_unique_names)-gbif_rainbow_intersect)/length(rainbow_unique_names)
# make a data frame of the relative proportions
prop_data <- data.frame(dataset = c(rep("GBIF",2), rep("Rainbow",2)), catetory = c(rep( c("Unique","Overlap"), 2)),
prop = c(num_gbif_non_overlap, gbif_rainbow_intersect/length(gbif_unique_names), num_rainbow_non_overlap, gbif_rainbow_intersect/length(rainbow_unique_names)))
# Make a stacked bar chart indicating the proportion of each list is devoted to the overlap between GBIF and rainbow
ggplot(prop_data, aes(x = dataset, y = prop, fill = catetory))+
geom_bar(stat = "identity", position = "fill")+
scale_y_continuous(labels = percent)+
scale_color_few("Dark", drop = FALSE)+
labs(x = "Species Lists", y= "Percentage", fill = "Category",
title = "Proportions of unique and overlapping",
subtitle = "GBIF vs Rainbow")+
theme(plot.title = element_text(face = "bold"),
axis.title.x = element_text(face = "bold"),
axis.title.y = element_text(face = "bold"),
axis.text = element_text(face = "bold"))
# Plot a venn diagram showing the overlap between unique species on GBIF and BC red/blue lists
gbif_red_blue_overlap <- draw.pairwise.venn(area1 = length(gbif_unique_names),
area2 = length(red_blue_unique_names),
cross.area = gbif_red_blue_intersect,
category = c("GBIF", "Red/Blue"),
lty = rep("blank", 2),
fill = c("purple", "cyan"),
alpha = rep(0.5,2),
cat.dist = rep(0.025, 2),
scaled = T,
cat.fontface = rep("bold", 2),
ext.text = F,
cat.pos = c(-25, 10))
# make the ven diagram plot titles
title2 <- textGrob("GBIF and BC Red & Blue", gp=gpar(fontface = "bold"))
subtitle2 <- textGrob("Overlap of unique species", gp=gpar(fontface = "bold"))
grid.arrange(gTree(children = gbif_red_blue_overlap), top = title2, bottom = subtitle2)
gbif_red_blue_overlap
# Record the proportion of unqiue species that do not overlap with the other list (ie BC red/blue or gbif)
prop_gbif_non_overlap2 <- (length(gbif_unique_names)-gbif_red_blue_intersect)/length(gbif_unique_names)
prop_redBlue_non_overlap <- (length(red_blue_unique_names)-gbif_red_blue_intersect)/length(red_blue_unique_names)
# make a data frame of the relative proportions
prop_data2 <- data.frame(dataset = c(rep("GBIF",2), rep("Red/Blue",2)), catetory = c(rep( c("Unique","Overlap"), 2)),
prop = c(num_gbif_non_overlap2, gbif_red_blue_intersect/length(gbif_unique_names), num_redBlue_non_overlap, gbif_red_blue_intersect/length(red_blue_unique_names)))
# Make a stacked bar chart indicating the proportion of each list is devoted to the overlap between GBIF and BC red/blue
ggplot(prop_data2, aes(x = dataset, y = prop, fill = catetory))+
geom_bar(stat = "identity", position = "fill")+
scale_y_continuous(labels = percent)+
scale_color_few("Dark", drop = FALSE)+
labs(x = "Species Lists", y= "Percentage", fill = "Category",
title = "Proportions of unique and overlapping",
subtitle = "GBIF vs Red/Blue")+
theme(plot.title = element_text(face = "bold"),
axis.title.x = element_text(face = "bold"),
axis.title.y = element_text(face = "bold"),
axis.text = element_text(face = "bold"))
# Subset GBIF plants
plants_gbif <- filter(trimmed_gbif, kingdom=="Plantae")
# get the unique plant names
plant_gbif_unique_names <- unique(plants_gbif$simplified_names)
# Subset rainbow plants
plants_rainbow <- filter(rainbow_list, Kingdom=="Plantae") %>%
filter(Phylum!="Mitosporic fungi" & Phylum!="Ascomycota")
# Get unique rainbow plant names
plant_rainbow_unique_names <- unique(plants_rainbow$simplified_names)
# Make a stacked bar chart indicating the proportion of each list is devoted to plants on GBIF and rainbow
ggplot(prop_data3, aes(x = dataset, y = prop, fill = catetory))+
geom_bar(stat = "identity", position = "fill")+
scale_y_continuous(labels = percent)+
scale_color_few("Dark", drop = FALSE)+
labs(x = "Species Lists", y= "Percentage", fill = "Category",
title = "Proportions of Plant and Non-plant",
subtitle = "GBIF vs Rainbow")+
theme(plot.title = element_text(face = "bold"),
axis.title.x = element_text(face = "bold"),
axis.title.y = element_text(face = "bold"),
axis.text = element_text(face = "bold"))
# Calculate the composition of GBIF and Rainbow in terms of how many plants they have.
# Record the number of unqiue species that are not plants on either list  (ie rainbow or gbif)
prop_gbif_not_plant <- (length(gbif_unique_names)-length(plant_gbif_unique_names))/length(gbif_unique_names)
prop_rainbow_not_plant <- (length(rainbow_unique_names)-length(plant_rainbow_unique_names))/length(rainbow_unique_names)
# make a data frame of the relative proportions
prop_data3 <- data.frame(dataset = c(rep("GBIF",2), rep("Rainbow",2)), catetory = c(rep( c("Non-Plant","Plant"), 2)),
prop = c(prop_gbif_not_plant, length(plant_gbif_unique_names)/length(gbif_unique_names), prop_rainbow_not_plant,
length(plant_rainbow_unique_names)/length(rainbow_unique_names)))
# Make a stacked bar chart indicating the proportion of each list is devoted to plants on GBIF and rainbow
ggplot(prop_data3, aes(x = dataset, y = prop, fill = catetory))+
geom_bar(stat = "identity", position = "fill")+
scale_y_continuous(labels = percent)+
scale_color_few("Dark", drop = FALSE)+
labs(x = "Species Lists", y= "Percentage", fill = "Category",
title = "Proportions of Plant and Non-plant",
subtitle = "GBIF vs Rainbow")+
theme(plot.title = element_text(face = "bold"),
axis.title.x = element_text(face = "bold"),
axis.title.y = element_text(face = "bold"),
axis.text = element_text(face = "bold"))
# How many of the unique GBIF plant species are found on rainbow list?
gbif_plant_on_rainbow <- sum(plants_gbif_unique_names%in%rainbow_unique_names);gbif_plant_on_rainbow
# Plot a venn diagram showing the overlap between unique species on GBIF plant and rainbow plants
gbif_plant_rainbow_overlap <- draw.pairwise.venn(area1 = length(plant_gbif_unique_names),
area2 = length(plant_rainbow_unique_names),
cross.area = gbif_plant_on_rainbow,
category = c("GBIF Plant", "Rainbow Plant"),
lty = rep("blank", 2),
fill = c("purple", "cyan"),
alpha = rep(0.5,2),
cat.dist = rep(0.025, 2),
scaled = T,
cat.fontface = rep("bold", 2),
ext.text = F,
cat.pos = c(-25, 20))
# make the ven diagram plot titles
title3 <- textGrob("GBIF and Rainbow Plants", gp=gpar(fontface = "bold"))
subtitle3 <- textGrob("Overlap of unique plant species", gp=gpar(fontface = "bold"))
grid.arrange(gTree(children = gbif_plant_rainbow_overlap), top = title3, bottom = subtitle3)
# What percent of GBIF plants are found on rainbow?
gbif_plant_on_rainbow/length(plant_gbif_unique_names)*100
# What percent of rainbow plants are found on GBIF?
gbif_plant_on_rainbow/length(plant_rainbow_unique_names)*100
# Record the number of unqiue species that do not overlap with the other list (ie rainbow plant or gbif plant)
prop_gbif_non_overlap4 <- (length(plant_gbif_unique_names)-gbif_plant_on_rainbow)/length(plant_gbif_unique_names)
prop_rainbow_non_overlap4 <- (length(plant_rainbow_unique_names)-gbif_plant_on_rainbow)/length(plant_rainbow_unique_names)
# make a data frame of the relative proportions
prop_data4 <- data.frame(dataset = c(rep("GBIF Plant",2), rep("Rainbow Plant",2)), catetory = c(rep( c("Unique","Overlap"), 2)),
prop = c(num_gbif_non_overlap4, gbif_plant_on_rainbow/length(plant_gbif_unique_names), num_rainbow_non_overlap4,
gbif_plant_on_rainbow/length(plant_rainbow_unique_names)))
# Make a stacked bar chart indicating the proportion of each list is devoted to the overlap between GBIF and rainbow plants
ggplot(prop_data4, aes(x = dataset, y = prop, fill = catetory))+
geom_bar(stat = "identity", position = "fill")+
scale_y_continuous(labels = percent)+
scale_color_few("Dark", drop = FALSE)+
labs(x = "Species Lists", y= "Percentage", fill = "Category",
title = "Proportions of unique and overlapping",
subtitle = "GBIF Plant vs Rainbow Plant")+
theme(plot.title = element_text(face = "bold"),
axis.title.x = element_text(face = "bold"),
axis.title.y = element_text(face = "bold"),
axis.text = element_text(face = "bold"))
# What percent of GBIF as a whole are the plants found on rainbow?
gbif_plant_on_rainbow/length(na.omit(unique(trimmed_gbif$species)))*100
# What percent of rainbow are the plants found on GBIF?
gbif_plant_on_rainbow/nrow(rainbow_list)*100
# Subset the GBIF animals
animal_gbif <- filter(trimmed_gbif, kingdom=="Animalia")
# Get unique animal names
animal_gbif_unique_names <- unique(animal_gbif$simplified_names)
# Subset the rainbow animals
animal_rainbow <- filter(rainbow_list, Kingdom=="Animalia")
# Get unique animal names from rainbow
animal_rainbow_unique_names <- unique(animal_rainbow$simplified_names)
# Calculate the composition of GBIF and Rainbow in terms of how many animals they have.
# Record the number of unqiue species that are not animals on either list  (ie rainbow or gbif)
prop_gbif_not_animal <- (length(gbif_unique_names)-length(animal_gbif_unique_names))/length(gbif_unique_names)
prop_rainbow_not_animal <- (length(rainbow_unique_names)-length(animal_rainbow_unique_names))/length(rainbow_unique_names)
# make a data frame of the relative proportions
prop_data5 <- data.frame(dataset = c(rep("GBIF",2), rep("Rainbow",2)), catetory = c(rep( c("Non-Animal","Animal"), 2)),
prop = c(prop_gbif_not_animal, length(animal_gbif_unique_names)/length(gbif_unique_names), prop_rainbow_not_animal,
length(animal_rainbow_unique_names)/length(rainbow_unique_names)))
# Make a stacked bar chart indicating the proportion of each list is devoted to animals on GBIF and rainbow
ggplot(prop_data5, aes(x = dataset, y = prop, fill = catetory))+
geom_bar(stat = "identity", position = "fill")+
scale_y_continuous(labels = percent)+
scale_color_few("Dark", drop = FALSE)+
labs(x = "Species Lists", y= "Percentage", fill = "Category",
title = "Proportions of Animal and Non-animal",
subtitle = "GBIF vs Rainbow")+
theme(plot.title = element_text(face = "bold"),
axis.title.x = element_text(face = "bold"),
axis.title.y = element_text(face = "bold"),
axis.text = element_text(face = "bold"))
# How many of the unique GBIF animal species are found on rainbow list?
gbif_animal_on_rainbow <- sum(animal_gbif_unique_names%in%rainbow_unique_names);gbif_animal_on_rainbow
# Plot a venn diagram showing the overlap between unique species on GBIF animal and rainbow animals
gbif_animal_rainbow_overlap <- draw.pairwise.venn(area1 = length(animal_gbif_unique_names),
area2 = length(animal_rainbow_unique_names),
cross.area = gbif_animal_on_rainbow,
category = c("GBIF Animal", "Rainbow Animal"),
lty = rep("blank", 2),
fill = c("purple", "cyan"),
alpha = rep(0.5,2),
cat.dist = rep(0.025, 2),
scaled = T,
cat.fontface = rep("bold", 2),
ext.text = F,
cat.pos = c(-25, -15))
# make the ven diagram plot titles
title4 <- textGrob("GBIF and Rainbow Animals", gp=gpar(fontface = "bold"))
subtitle4 <- textGrob("Overlap of unique animal species", gp=gpar(fontface = "bold"))
grid.arrange(gTree(children = gbif_animal_rainbow_overlap), top = title4, bottom = subtitle4)
# Plot a venn diagram showing the overlap between unique species on GBIF animal and rainbow animals
gbif_animal_rainbow_overlap <- draw.pairwise.venn(area1 = length(animal_gbif_unique_names),
area2 = length(animal_rainbow_unique_names),
cross.area = gbif_animal_on_rainbow,
category = c("GBIF Animal", "Rainbow Animal"),
lty = rep("blank", 2),
fill = c("purple", "cyan"),
alpha = rep(0.5,2),
cat.dist = rep(0.025, 2),
scaled = T,
cat.fontface = rep("bold", 2),
ext.text = F,
cat.pos = c(-40, -15))
# make the ven diagram plot titles
title4 <- textGrob("GBIF and Rainbow Animals", gp=gpar(fontface = "bold"))
subtitle4 <- textGrob("Overlap of unique animal species", gp=gpar(fontface = "bold"))
grid.arrange(gTree(children = gbif_animal_rainbow_overlap), top = title4, bottom = subtitle4)
# Plot a venn diagram showing the overlap between unique species on GBIF animal and rainbow animals
gbif_animal_rainbow_overlap <- draw.pairwise.venn(area1 = length(animal_gbif_unique_names),
area2 = length(animal_rainbow_unique_names),
cross.area = gbif_animal_on_rainbow,
category = c("GBIF Animal", "Rainbow Animal"),
lty = rep("blank", 2),
fill = c("purple", "cyan"),
alpha = rep(0.5,2),
cat.dist = rep(0.025, 2),
scaled = T,
cat.fontface = rep("bold", 2),
ext.text = F,
cat.pos = c(-90, -15))
# make the ven diagram plot titles
title4 <- textGrob("GBIF and Rainbow Animals", gp=gpar(fontface = "bold"))
subtitle4 <- textGrob("Overlap of unique animal species", gp=gpar(fontface = "bold"))
grid.arrange(gTree(children = gbif_animal_rainbow_overlap), top = title4, bottom = subtitle4)
# Plot a venn diagram showing the overlap between unique species on GBIF animal and rainbow animals
gbif_animal_rainbow_overlap <- draw.pairwise.venn(area1 = length(animal_gbif_unique_names),
area2 = length(animal_rainbow_unique_names),
cross.area = gbif_animal_on_rainbow,
category = c("GBIF Animal", "Rainbow Animal"),
lty = rep("blank", 2),
fill = c("purple", "cyan"),
alpha = rep(0.5,2),
cat.dist = rep(0.025, 2),
scaled = T,
cat.fontface = rep("bold", 2),
ext.text = F,
cat.pos = c(-20, -15))
# make the ven diagram plot titles
title4 <- textGrob("GBIF and Rainbow Animals", gp=gpar(fontface = "bold"))
subtitle4 <- textGrob("Overlap of unique animal species", gp=gpar(fontface = "bold"))
grid.arrange(gTree(children = gbif_animal_rainbow_overlap), top = title4, bottom = subtitle4)
# Plot a venn diagram showing the overlap between unique species on GBIF animal and rainbow animals
gbif_animal_rainbow_overlap <- draw.pairwise.venn(area1 = length(animal_gbif_unique_names),
area2 = length(animal_rainbow_unique_names),
cross.area = gbif_animal_on_rainbow,
category = c("GBIF Animal", "Rainbow Animal"),
lty = rep("blank", 2),
fill = c("purple", "cyan"),
alpha = rep(0.5,2),
cat.dist = rep(0.025, 2),
scaled = T,
cat.fontface = rep("bold", 2),
ext.text = F,
cat.pos = c(-20, -40))
# make the ven diagram plot titles
title4 <- textGrob("GBIF and Rainbow Animals", gp=gpar(fontface = "bold"))
subtitle4 <- textGrob("Overlap of unique animal species", gp=gpar(fontface = "bold"))
grid.arrange(gTree(children = gbif_animal_rainbow_overlap), top = title4, bottom = subtitle4)
# Plot a venn diagram showing the overlap between unique species on GBIF animal and rainbow animals
gbif_animal_rainbow_overlap <- draw.pairwise.venn(area1 = length(animal_gbif_unique_names),
area2 = length(animal_rainbow_unique_names),
cross.area = gbif_animal_on_rainbow,
category = c("GBIF Animal", "Rainbow Animal"),
lty = rep("blank", 2),
fill = c("purple", "cyan"),
alpha = rep(0.5,2),
cat.dist = rep(0.025, 2),
scaled = T,
cat.fontface = rep("bold", 2),
ext.text = F,
cat.pos = c(-20, -10))
# make the ven diagram plot titles
title4 <- textGrob("GBIF and Rainbow Animals", gp=gpar(fontface = "bold"))
subtitle4 <- textGrob("Overlap of unique animal species", gp=gpar(fontface = "bold"))
grid.arrange(gTree(children = gbif_animal_rainbow_overlap), top = title4, bottom = subtitle4)
# Plot a venn diagram showing the overlap between unique species on GBIF animal and rainbow animals
gbif_animal_rainbow_overlap <- draw.pairwise.venn(area1 = length(animal_gbif_unique_names),
area2 = length(animal_rainbow_unique_names),
cross.area = gbif_animal_on_rainbow,
category = c("GBIF Animal", "Rainbow Animal"),
lty = rep("blank", 2),
fill = c("purple", "cyan"),
alpha = rep(0.5,2),
cat.dist = rep(0.025, 2),
scaled = T,
cat.fontface = rep("bold", 2),
ext.text = F,
cat.pos = c(-20, 10))
# make the ven diagram plot titles
title4 <- textGrob("GBIF and Rainbow Animals", gp=gpar(fontface = "bold"))
subtitle4 <- textGrob("Overlap of unique animal species", gp=gpar(fontface = "bold"))
grid.arrange(gTree(children = gbif_animal_rainbow_overlap), top = title4, bottom = subtitle4)
# What percent of GBIF animal are found on rainbow?
gbif_animal_on_rainbow/length(animal_gbif_unique_names)*100
# What percent of Rainbow animal list is the overlap with GBIF?
gbif_animal_on_rainbow/length(animal_rainbow_unique_names)*100
# Record the number of unqiue species that do not overlap with the other list (ie rainbow animal or gbif animal)
prop_gbif_non_overlap6 <- (length(animal_gbif_unique_names)-gbif_animal_on_rainbow)/length(animal_gbif_unique_names)
prop_rainbow_non_overlap6 <- (length(animal_rainbow_unique_names)-gbif_animal_on_rainbow)/length(animal_rainbow_unique_names)
# make a data frame of the relative proportions
prop_data6 <- data.frame(dataset = c(rep("GBIF Animal",2), rep("Rainbow Animal",2)), catetory = c(rep( c("Unique","Overlap"), 2)),
prop = c(num_gbif_non_overlap4, gbif_animal_on_rainbow/length(animal_gbif_unique_names), num_rainbow_non_overlap4,
gbif_animal_on_rainbow/length(animal_rainbow_unique_names)))
# Make a stacked bar chart indicating the proportion of each list is devoted to the overlap between GBIF and rainbow animals
ggplot(prop_data6, aes(x = dataset, y = prop, fill = catetory))+
geom_bar(stat = "identity", position = "fill")+
scale_y_continuous(labels = percent)+
scale_color_few("Dark", drop = FALSE)+
labs(x = "Species Lists", y= "Percentage", fill = "Category",
title = "Proportions of unique and overlapping",
subtitle = "GBIF Animal vs Rainbow Animal")+
theme(plot.title = element_text(face = "bold"),
axis.title.x = element_text(face = "bold"),
axis.title.y = element_text(face = "bold"),
axis.text = element_text(face = "bold"))
# Subset the GBIF fungi
fungi_gbif <- filter(trimmed_gbif, kingdom=="Fungi")
# Get the unqiue fungi names
fungi_gbif_unique_names <- unique(fungi_gbif$simplified_names)
# Subst the rainbow fungi
fungi_rainbow <- filter(rainbow_list, Phylum=="Mitosporic fungi" | Phylum=="Ascomycota")
# Get the unique fungi names
fungi_rainbow_unique_names <- unique(fungi_rainbow$simplified_names)
# Unqiue fungi species are what percent of the GBIF unique species?
length(fungi_gbif_unique_names)/length(gbif_unique_names)*100
# Calculate the composition of GBIF and Rainbow in terms of how many fungi they have.
# Record the number of unqiue species that are not fungi on either list  (ie rainbow or gbif)
prop_gbif_not_fungi <- (length(gbif_unique_names)-length(fungi_gbif_unique_names))/length(gbif_unique_names)
prop_rainbow_not_fungi <- (length(rainbow_unique_names)-length(fungi_rainbow_unique_names))/length(rainbow_unique_names)
# make a data frame of the relative proportions
prop_data7 <- data.frame(dataset = c(rep("GBIF",2), rep("Rainbow",2)), catetory = c(rep( c("Non-Fungi","Fungi"), 2)),
prop = c(prop_gbif_not_fungi, length(fungi_gbif_unique_names)/length(gbif_unique_names), prop_rainbow_not_fungi,
length(fungi_rainbow_unique_names)/length(rainbow_unique_names)))
# Calculate the composition of GBIF and Rainbow in terms of how many fungi they have.
# Record the number of unqiue species that are not fungi on either list  (ie rainbow or gbif)
prop_gbif_not_fungi <- (length(gbif_unique_names)-length(fungi_gbif_unique_names))/length(gbif_unique_names)
prop_rainbow_not_fungi <- (length(rainbow_unique_names)-length(fungi_rainbow_unique_names))/length(rainbow_unique_names)
# make a data frame of the relative proportions
prop_data7 <- data.frame(dataset = c(rep("GBIF",2), rep("Rainbow",2)), catetory = c(rep( c("Non-Fungi","Fungi"), 2)),
prop = c(prop_gbif_not_fungi, length(fungi_gbif_unique_names)/length(gbif_unique_names), prop_rainbow_not_fungi,
length(fungi_rainbow_unique_names)/length(rainbow_unique_names)))
# Make a stacked bar chart indicating the proportion of each list is devoted to plants on GBIF and rainbow
ggplot(prop_data7, aes(x = dataset, y = prop, fill = catetory))+
geom_bar(stat = "identity", position = "fill")+
scale_y_continuous(labels = percent)+
scale_color_few("Dark", drop = FALSE)+
labs(x = "Species Lists", y= "Percentage", fill = "Category",
title = "Proportions of Fungi and Non-fungi",
subtitle = "GBIF vs Rainbow")+
theme(plot.title = element_text(face = "bold"),
axis.title.x = element_text(face = "bold"),
axis.title.y = element_text(face = "bold"),
axis.text = element_text(face = "bold"))
# How many of the unique GBIF fungi species are found on rainbow list?
gbif_fungi_on_rainbow <- sum(na.omit(unique(fungi_gbif$species))%in%rainbow_list$Scientific.Name);gbif_fungi_on_rainbow
# Plot a venn diagram showing the overlap between unique species on GBIF fungi and rainbow fungi
gbif_fungi_rainbow_overlap <- draw.pairwise.venn(area1 = length(fungi_gbif_unique_names),
area2 = length(fungi_rainbow_unique_names),
cross.area = gbif_fungi_on_rainbow,
category = c("GBIF Fungi", "Rainbow Fungi"),
lty = rep("blank", 2),
fill = c("purple", "cyan"),
alpha = rep(0.5,2),
cat.dist = rep(0.025, 2),
scaled = T,
cat.fontface = rep("bold", 2),
ext.text = F,
cat.pos = c(-25, 20))
# make the ven diagram plot titles
title5 <- textGrob("GBIF and Rainbow Fungi", gp=gpar(fontface = "bold"))
subtitle5 <- textGrob("Overlap of unique fungal species", gp=gpar(fontface = "bold"))
grid.arrange(gTree(children = gbif_fungi_rainbow_overlap), top = title5, bottom = subtitle5)
# What percent of GBIF fungi are found on rainbow?
gbif_fungi_on_rainbow/length(fungi_gbif_unique_names)*100
# What percent of Rainbow fungi are found on GBIF?
gbif_fungi_on_rainbow/length(fungi_rainbow_unique_names)*100
# Record the proportion of unqiue species that do not overlap with the other list (ie rainbow fungi or gbif fungi)
prop_gbif_non_overlap8 <- (length(fungi_gbif_unique_names)-gbif_fungi_on_rainbow)/length(fungi_gbif_unique_names)
prop_rainbow_non_overlap8 <- (length(fungi_rainbow_unique_names)-gbif_fungi_on_rainbow)/length(fungi_rainbow_unique_names)
# make a data frame of the relative proportions
prop_data8 <- data.frame(dataset = c(rep("GBIF Fungi",2), rep("Rainbow Fungi",2)), catetory = c(rep( c("Unique","Overlap"), 2)),
prop = c(prop_gbif_non_overlap8, gbif_fungi_on_rainbow/length(fungi_gbif_unique_names), prop_rainbow_non_overlap8,
gbif_fungi_on_rainbow/length(fungi_rainbow_unique_names)))
# Make a stacked bar chart indicating the proportion of each list is devoted to the overlap between GBIF and rainbow fungi
ggplot(prop_data8, aes(x = dataset, y = prop, fill = catetory))+
geom_bar(stat = "identity", position = "fill")+
scale_y_continuous(labels = percent)+
scale_color_few("Dark", drop = FALSE)+
labs(x = "Species Lists", y= "Percentage", fill = "Category",
title = "Proportions of unique and overlapping",
subtitle = "GBIF Fungi vs Rainbow Fungi")+
theme(plot.title = element_text(face = "bold"),
axis.title.x = element_text(face = "bold"),
axis.title.y = element_text(face = "bold"),
axis.text = element_text(face = "bold"))
